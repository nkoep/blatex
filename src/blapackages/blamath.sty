% Copyright (c) 2015 Niklas Koep
%
% This software may be modified and distributed under the terms of the MIT
% license. See the LICENSE file for details.

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{blamath}[2015/03/18 v0.1]

\RequirePackage{blaenv}

\newif\if@boldmath\@boldmathfalse
\DeclareOption{boldmath}{
  \@boldmathtrue
}

\ProcessOptions\relax

\usepackage{amsmath,amssymb}
\usepackage{xparse}
\usepackage{pgffor}

% -- Sets --
\newcommand*{\@defineset}[1]{
  \expandafter\newcommand\csname #1\endcsname{\mathbb{#1}}
}
% Positive integers
\@defineset{N}
% Nonnegative integers
\newcommand*{\NN}{\mathbb{N}_0}
% Integers
\@defineset{Z}
% Rational numbers
\@defineset{Q}
% Real numbers
\@defineset{R}
% Complex numbers
\@defineset{C}
% Some number field F
\@defineset{F}

% -- Miscellaneous --
% Upright infinitesimal sign for things like df/dx, etc.
\renewcommand*{\d}[1]{\mathrm{d}#1}

% Define style of vectors and matrices.
\if@boldmath
  \def\@matrixvector #1{\boldsymbol{#1}}
\else
  \def\@matrixvector #1{\relax#1}
\fi
\newcommand*{\@makesymbol}[1]{%
  % Define a vector.
  \expandafter\newcommand\csname v#1\endcsname{\@matrixvector{#1}}%
  % Define a matrix.
  \expandafter\newcommand\csname m#1\endcsname{%
    \@matrixvector{\MakeUppercase{#1}}%
  }%
  % Define a random vector.
  \expandafter\newcommand\csname rv#1\endcsname{%
    \@matrixvector{\MakeUppercase{#1}}%
  }%
}

% TODO: Define these in a loop.
\@makesymbol{a}
\@makesymbol{b}
\@makesymbol{c}
\@makesymbol{d}
\@makesymbol{e}
\@makesymbol{f}
\@makesymbol{g}

% -- Operators & functions --
% Probability measure
\renewcommand*{\P}{\operatorname{P}}
% Expected value
\newcommand*{\E}{\mathrm{E}}
% Variance
\DeclareMathOperator{\Var}{Var}
% Covariance
\DeclareMathOperator{\Cov}{Cov}
% Entropy
\DeclareMathOperator{\ent}{H}
% Mutual information
\newcommand*{\mi}[2]{\operatorname{I}\left(#1;#2\right)}
% Rank
\DeclareMathOperator{\rank}{rank}
% Trace
\DeclareMathOperator{\tr}{tr}
% Transpose
\newcommand*{\transp}[1]{#1^\top}
% Adjoint
\newcommand*{\adj}[1]{#1^*}
% Orthogonal complement
\newcommand*{\ocomp}[1]{#1^\bot}
% Real and imaginary part
\renewcommand*{\Re}{\operatorname{Re}}
\renewcommand*{\Im}{\operatorname{Im}}
% Inner product
\newcommand*{\inner}[2]{\left\langle#1,#2\right\rangle}
% Diagonal matrix
\newcommand*{\diag}[1]{\operatorname{diag}\left\{#1\right\}}
% Cardinality of a set
\newcommand*{\card}{\#}
% Signum function
\DeclareMathOperator{\sgn}{sgn}
% Function domain
\newcommand*{\dom}{\mathoperator{dom}}
% argmin
\newcommand{\argmin}[2]{\operatorname*{argmin}_{#1}\left\{#2\right\}}
% argmax
\newcommand{\argmax}[2]{\operatorname*{argmax}_{#1}\left\{#2\right\}}
% arginf
\newcommand{\arginf}[2]{\operatorname*{arginf}_{#1}\left\{#2\right\}}
% argsup
\newcommand{\argsup}[2]{\operatorname*{argsup}_{#1}\left\{#2\right\}}
% Proximal operator
\DeclareMathOperator{\prox}{prox}

% Math environments
\DeclareDocumentCommand{\Equation}{s m}{%
  \IfBooleanTF{#1}{\Env{align*}{#2}}{\Env{align}{#2}}
}
\newcommand*{\Pmatrix}[1]{\Env{pmatrix}{#1}}
\newcommand*{\Cases}[1]{\Env{cases}{#1}}

\endinput

