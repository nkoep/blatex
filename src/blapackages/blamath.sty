% Copyright (c) 2015 Niklas Koep
%
% This software may be modified and distributed under the terms of the MIT
% license. See the LICENSE file for details.

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{blamath}[2015/03/18 v0.1]

\RequirePackage{blaenv}

\newif\if@boldmath\@boldmathfalse
\DeclareOption{boldmath}{
  \@boldmathtrue
}

\ProcessOptions\relax

\usepackage{amsmath,amssymb}
\usepackage{xparse}
\usepackage{pgffor}

% -- Sets --
\newcommand*{\@defineset}[1]{
  \expandafter\newcommand\csname #1\endcsname{\mathbb{#1}}
}
% Positive integers
\@defineset{N}
% Nonnegative integers
\newcommand*{\NN}{\mathbb{N}_0}
% Integers
\@defineset{Z}
% Rational numbers
\@defineset{Q}
% Real numbers
\@defineset{R}
% Complex numbers
\@defineset{C}
% Some number field F
\@defineset{F}

% -- Miscellaneous --
% Upright infinitesimal sign for things like df/dx, etc.
\renewcommand*{\d}[1]{\mathrm{d}#1}

% Define style of vectors and matrices.
\if@boldmath
  \def\@symbolstyle #1{\boldsymbol{#1}}
\else
  \def\@symbolstyle #1{\relax#1}
\fi
% Typeset a symbol as (v)ector or (m)atrix.
\newcommand*{\vm}[1]{\@symbolstyle{#1}}
% Define a range of symbols.
\newcommand*{\@definesymbols}[1]{
  \foreach \s in {#1}{
    \expandafter\xdef\csname vm\s\endcsname{\noexpand\vm{\s}}
  }
}
% Define a range of symbols, but treat arguments as macros (e.g., \alpha rather
% than alpha).
\newcommand*{\@xdefinesymbols}[1]{
  \foreach \s in {#1}{
    \expandafter\xdef\csname vm\s\endcsname{\noexpand\vm{\csname \s\endcsname}}
  }
}
\@definesymbols{a,...,z}
\@definesymbols{A,...,Z}
\@xdefinesymbols{
  alpha,beta,gamma,delta,epsilon,varepsilon,zeta,eta,theta,vartheta,iota,kappa,
  lambda,mu,nu,xi,o,pi,rho,varrho,sigma,tau,upsilon,phi,varphi,chi,psi,omega
}
\@xdefinesymbols{
  Gamma,Delta,Theta,Lambda,Xi,Pi,Sigma,Upsilon,Phi,Psi,Omega
}

% -- Operators & functions --
% Probability measure
\renewcommand*{\P}{\operatorname{P}}
% Expected value
\newcommand*{\E}{\mathrm{E}}
% Variance
\DeclareMathOperator{\var}{Var}
% Covariance
\DeclareMathOperator{\cov}{Cov}
% Entropy
\DeclareMathOperator{\ent}{H}
% Mutual information
\newcommand*{\mi}[2]{\operatorname{I}\left(#1;#2\right)}
% Rank
\DeclareMathOperator{\rank}{rank}
% Trace
\DeclareMathOperator{\tr}{tr}
% Transpose
\newcommand*{\transp}[1]{#1^\top}
% Adjoint
\newcommand*{\adj}[1]{#1^*}
% Orthogonal complement
\newcommand*{\ocomp}[1]{#1^\bot}
% Real and imaginary part
\renewcommand*{\Re}{\operatorname{Re}}
\renewcommand*{\Im}{\operatorname{Im}}
% Inner product
\newcommand*{\inner}[2]{\left\langle#1,#2\right\rangle}
% Diagonal matrix
\newcommand*{\diag}[1]{\operatorname{diag}\left\{#1\right\}}
% Cardinality of a set
\newcommand*{\card}{\#}
% Signum function
\DeclareMathOperator{\sgn}{sgn}
% Function domain
\newcommand*{\dom}{\mathoperator{dom}}
% argmin
\newcommand*{\argmin}[2]{\operatorname*{argmin}_{#1}\left\{#2\right\}}
% argmax
\newcommand*{\argmax}[2]{\operatorname*{argmax}_{#1}\left\{#2\right\}}
% arginf
\newcommand*{\arginf}[2]{\operatorname*{arginf}_{#1}\left\{#2\right\}}
% argsup
\newcommand*{\argsup}[2]{\operatorname*{argsup}_{#1}\left\{#2\right\}}
% Proximal operator
\DeclareMathOperator{\prox}{prox}

% Math environments
\DeclareDocumentCommand{\Equation}{s m}{%
  \IfBooleanTF{#1}{\Env{align*}{#2}}{\Env{align}{#2}}
}
\newcommand*{\Matrix}[1]{\Env{pmatrix}{#1}}
\newcommand*{\Cases}[1]{\Env{cases}{#1}}

\endinput

